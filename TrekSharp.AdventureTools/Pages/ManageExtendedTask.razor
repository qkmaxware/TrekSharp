@page "/manage/task/extended"
@inherits Page

<div class="lcars">
    <div class="container">
        <LCARS Title="EXTENDED TASKS">
            <div class="w3-padding row-fill">
                @foreach (var task in Data.Tasks) {
                    <div class="container">
                        <!-- Title -->
                        <div class="row">
                            <span class="hbar elbow-left knee-left w3-padding">EXTENDED TASK</span>
                            <span class="hbar row-fill" style="margin-left: 10px;">
                                <input type="text" class="w3-padding" style="width: 100%;" @bind="task.Name"/>
                            </span>
                        </div>
                        <!-- Characteristics -->
                        <div class="w3-row w3-padding w3-row-padding">
                            <div class="w3-third row">
                                <div class="knee-left elbow-left hbar highlight">Difficulty</div>
                                <div class="row-fill" style="margin-left: 10px;">
                                    <input type="number" style="width: 100%;" @bind="task.Difficulty"/> 
                                </div>
                            </div>
                            <div class="w3-third row">
                                <div class="knee-left elbow-left hbar highlight">Magnitude</div>
                                <div class="row-fill" style="margin-left: 10px;">
                                    <input type="number" style="width: 100%;" @bind="task.Magnitude"/> 
                                </div>
                            </div>
                            <div class="w3-third row">
                                <div class="knee-left elbow-left hbar highlight">Resistance</div>
                                <div class="row-fill" style="margin-left: 10px;">
                                    <input type="number" style="width: 100%;" @bind="task.Resistance"/> 
                                </div>
                            </div>
                        </div>
                        <!-- Progress -->
                        <div class="w3-row w3-padding w3-row-padding">
                            <div class="w3-threequarter row">
                                <div class="knee-left elbow-left hbar secondary" style="line-height: 400%;">Work Track</div>
                                <div class="row-fill w3-black border-primary" style="margin-left: 10px;">
                                    <input type="number" readonly style="width: 100%;" @bind="task.TotalWork"/> 
                                    <br>
                                    <input type="number" style="width: 100%;" @bind="task.WorkTrack"/> 
                                </div>
                            </div>
                            <div class="w3-quarter row">
                                <div class="knee-left elbow-left hbar secondary" style="line-height: 400%;">Breakthroughs</div>
                                <div class="row-fill" style="margin-left: 10px;">
                                    <input type="number" style="width: 100%; height: 100%;" @bind="task.Breakthroughs"/> 
                                </div>
                            </div>
                        </div>
                        <div class="w3-row w3-padding w3-row-padding">
                            <div class="w3-half">
                                <input type="number" @bind="task.RollsAgainst"/>
                                <button @onclick="@(() => { task.ApplyRollsAgainst(); StateHasChanged(); })">+ Work</button>
                            </div>
                            <div class="w3-half w3-right-align">
                                <button class="w3-red" @onclick="@(() => { Data.Tasks.Remove(task); })">Delete</button>
                            </div>
                        </div>
                        <!-- Footer -->
                        <div class="row">
                            <div class="hbar knee-left elbow-left row-fill knee-right elbow-right w3-right-align">   
                            </div>
                        </div>
                    </div>
                }
                <hr>
                <div class="w3-right-align">
                    <button @onclick="NewTask">
                        New Task +
                    </button>
                </div>
            </div>
        </LCARS>
    </div>
</div>



@code {

    private void NewTask() {
        Data.Tasks.Add(new ExtendedTask("Extended Task", 1, 20, 3, 0));
    }
    private void DeleteTask(ExtendedTask task) {
        Data.Tasks.Remove(task);
    }

}